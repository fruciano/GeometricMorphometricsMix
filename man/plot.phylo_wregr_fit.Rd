% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phylo_wregr.R
\name{plot.phylo_wregr_fit}
\alias{plot.phylo_wregr_fit}
\title{Plot method for phylo_wregr_fit objects}
\usage{
\method{plot}{phylo_wregr_fit}(x, what = c("rsquared", "coefficients"), plot_phylogeny = TRUE, ...)
}
\arguments{
\item{x}{An object of class `phylo_wregr_fit`, typically the result of \code{\link{phylo_w_regr_fit}}}

\item{what}{Character string specifying what to plot. Either "rsquared" for R-squared values
or "coefficients" for regression coefficients. Default is "rsquared".}

\item{plot_phylogeny}{Logical indicating whether to include phylogenetic information in plots.
When TRUE, uses phylogenetic plotting functions from the phytools package. Default is TRUE.}

\item{...}{Additional arguments passed to the underlying plotting functions (e.g., graphical parameters)}
}
\value{
Invisibly returns the input object x
}
\description{
Visualizes the results of phylogenetic weighted regression analysis. The function can plot
either R-squared values or regression coefficients, with or without phylogenetic context.
For multivariate coefficients, Principal Component Analysis is performed and the first two
components are plotted. When phylogenetic context is included, the plots are overlaid on
the phylogenetic tree structure.
}
\details{
The function uses different visualization approaches depending on the data type and user preferences:

\strong{For R-squared values:}
\itemize{
  \item With phylogeny: Uses \code{phytools::plotTree.wBars} to show values as bars along tree tips
  \item Without phylogeny: Uses \code{stats::density} to show the distribution of R-squared values
}

\strong{For coefficients:}
\itemize{
  \item Multivariate case with phylogeny: Performs PCA using \code{stats::prcomp} and plots the first
    two components in phylomorphospace using \code{phytools::phylomorphospace}
  \item Multivariate case without phylogeny: Plots PC1 vs PC2 scores using base \code{plot}
  \item Univariate case with phylogeny: Uses \code{phytools::plotTree.wBars}
  \item Univariate case without phylogeny: Uses \code{stats::density}
}
}
\note{
The phytools package is required when \code{plot_phylogeny = TRUE}. The function will
throw an error if phytools is not installed and phylogenetic plots are requested.
}
\examples{
# Same example as the main function but with more complex plotting
# using the attributes passed to functions in phytools
library(phytools)
library(viridisLite)

set.seed(123)

tree = pbtree(n=20)
# Generate a tre with 20 tips

Y = matrix(rnorm(100), nrow=20)
X = rnorm(20)
result = phylo_w_regr_fit(tree, Y, X)

color_inferno=inferno(n=100, direction = -1)
# Create a color palette for the R-squared values using 100 values
# with lighter colours representing smaller values
# see also ?inferno
color_result_rsquared=sapply(result$rsquared,
                            function(x) color_inferno[round(x*100)])
# Map the values of rsquared to the color palette
plot(result, what = "rsquared", plot_phylogeny = TRUE,
     type = "phylogram", col = color_result_rsquared)
# Plot the phylogeny with the bars and the colours representing the R-squared values
# Now add a legend of colours and rsquared value covering all range in color_turbo




}
\seealso{
\code{\link{phylo_w_regr_fit}} for the main function that generates objects of this class
}
