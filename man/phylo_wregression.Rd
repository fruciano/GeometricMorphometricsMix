% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phylo_wregr.R
\name{phylo_wregression}
\alias{phylo_wregression}
\title{Phylogenetically weighted regression with optional simulations}
\usage{
phylo_wregression(tree, Y, X, nsim = 1000, model = "BM", ncores = 1)
}
\arguments{
\item{tree}{An object of class `phylo` (from the `ape` package).}

\item{Y}{A numeric vector, matrix, or data.frame of response variables
(rows correspond to tips in `tree`).}

\item{X}{A numeric vector or factor of predictor values (length must match
number of tips).}

\item{nsim}{Integer; number of parametric simulations to perform. If 0,
only the observed phylogenetic-weighted regression is returned. Default
is 1000.}

\item{model}{Character; evolutionary model used for simulation. Passed to
the PGLS simulation routine (e.g. "BM").}

\item{ncores}{Integer; number of cores to use for simulations. Default is 1.}
}
\value{
If `nsim == 0`, returns the object produced by
  `phylo_w_regr_fit()` (class `phylo_wregr_fit`) containing at least
  elements `tree`, `rsquared`, `intercepts`, `coefficients`, and
  `weights`.

If `nsim > 0`, returns a named list used for inference. Typical components
include:
\describe{
  \item{PGLS_model_fit}{The fitted PGLS model used to generate simulations.}
  \item{Simulated_coefficients}{A list (or matrix for univariate Y) of simulated
    phylogenetic-weighted regression coefficients, one element per simulation.}
  \item{angle_comparisons_with_simulations}{A data.frame with observed angles
    and summaries (min, max, 95% quantile) from simulations, plus logical
    columns indicating exceedance of simulation-based thresholds or a
    critical angle.}
}
}
\description{
Fit a phylogenetic-weighted regression for each tip of a phylogeny
(for both univariate and multivariate dependent variables)and,
optionally, perform parametric simulations under a PGLS model to evaluate
whether observed tip-level coefficients differ from expectations under
the PGLS model fitted across the whole tree.
}
\details{
This is the primary user-facing function in this source file. It returns
either the observed phylogenetic weighted regression fit (an internal
`phylo_wregr_fit` object) or, when `nsim > 0`, a list that contains the
fitted PGLS model, simulated phylogenetic-weighted regression coefficients and
summaries comparing observed and simulated coefficients


The function for the case where nsim>0 relies on `mvMORPH` and, in case of univariate data,
 `phylolm` (which should, therefore, be installed)
}
\examples{
# Assuming 'tree', 'Y' and 'X' are available in the session:
# result = phylo_wregression(tree, Y, X, nsim = 100)
# print(result)

}
