% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/phylo_wregr.R
\name{phylo_w_regr_fit}
\alias{phylo_w_regr_fit}
\title{Phylogenetic Weighted Regression for Comparative Data}
\usage{
phylo_w_regr_fit(tree, Y, X)
}
\arguments{
\item{tree}{An object of class `phylo` (from the `ape` package) representing the phylogenetic tree.}

\item{Y}{A numeric vector, matrix, or data frame of response variables. Each column is treated as a trait.}

\item{X}{A numeric vector or factor of predictor values (e.g., trait or grouping variable).}
}
\value{
A list containing:
  \item{tree}{The input phylogenetic tree.}
  \item{rsquared}{A named vector of R-squared values for each tip.}
  \item{intercepts}{A matrix of intercepts for each tip.}
  \item{coefficients}{A matrix of regression coefficients for each tip.}
  \item{weights}{The phylogenetic correlation matrix used as weights.}
}
\description{
Performs a phylogenetic weighted regression for each tip in a phylogenetic tree,
using a Brownian motion correlation structure. The function fits a weighted linear model
for each tip, computes R-squared, intercepts, and coefficients, and returns these along
with the weights matrix and the input tree.
}
\details{
This function uses `ape::corBrownian` to compute the phylogenetic correlation structure,
and `nlme::corMatrix` to extract the weights matrix. Weighted linear models are fit using
`stats::lm`. The function is suitable for comparative analyses where phylogenetic signal
and trait evolution are modeled under Brownian motion.

The returned object has class `phylo_wregr_fit` and has an associated S3 plot method
for visualizing results (see \code{\link{plot.phylo_wregr_fit}}).
}
\examples{
# Simulate a tree and traits
library(phytools)
tree = pbtree(n=20)
# Generate a tre with 20 tips

Y = matrix(rnorm(100), nrow=20)
X = rnorm(20)
result = phylo_w_regr_fit(tree, Y, X)
str(result)

# Plot R-squared values with phylogeny
plot(result, what = "rsquared")

# Plot R-squared values without phylogeny
plot(result, what = "rsquared", plot_phylogeny = FALSE)

# Plot a PCA of coefficients with superimposed the phylogeny
# (a so called "phylomorphospace" plot)
plot(result, what = "coefficients")

# Plot coefficients without phylogeny
plot(result, what = "coefficients", plot_phylogeny = FALSE)

# Single trait example
Y_single = rnorm(20)
result_single = phylo_w_regr_fit(tree, Y_single, X)
plot(result_single, what = "coefficients")
}
\seealso{
\code{\link{plot.phylo_wregr_fit}} for plotting the results
}
